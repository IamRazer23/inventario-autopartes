<!-- Menú Horizontal Cliente -->
<?php 
// Obtener contador del carrito
$carritoItems = $_SESSION['carrito_items'] ?? 0;
$currentAction = $_GET['action'] ?? '';
$currentModule = $_GET['module'] ?? '';
?>
<nav class="bg-gradient-to-r from-green-700 to-green-600 border-b border-green-800 shadow-lg">
    <div class="container mx-auto px-4">
        <ul class="flex items-center space-x-1 overflow-x-auto scrollbar-hide py-1">
            
            <!-- Dashboard -->
            <li>
                <a href="<?= BASE_URL ?>/index.php?module=cliente&action=dashboard" 
                   class="flex items-center space-x-2 px-4 py-3 text-white hover:bg-green-800 rounded-lg transition-colors whitespace-nowrap <?= ($currentModule == 'cliente' && $currentAction == 'dashboard') ? 'bg-green-800' : '' ?>">
                    <i class="fas fa-tachometer-alt"></i>
                    <span class="font-medium">Mi Panel</span>
                </a>
            </li>

            <!-- Explorar Catálogo -->
            <li>
                <a href="<?= BASE_URL ?>/index.php?module=publico&action=catalogo" 
                   class="flex items-center space-x-2 px-4 py-3 text-white hover:bg-green-800 rounded-lg transition-colors whitespace-nowrap <?= ($currentModule == 'publico' && $currentAction == 'catalogo') ? 'bg-green-800' : '' ?>">
                    <i class="fas fa-store"></i>
                    <span class="font-medium">Catálogo</span>
                </a>
            </li>

            <!-- Mi Carrito -->
            <li>
                <a href="<?= BASE_URL ?>/index.php?module=carrito&action=ver" 
                   class="flex items-center space-x-2 px-4 py-3 text-white hover:bg-green-800 rounded-lg transition-colors whitespace-nowrap <?= ($currentModule == 'carrito' && in_array($currentAction, ['ver', 'index', 'checkout'])) ? 'bg-green-800' : '' ?>">
                    <i class="fas fa-shopping-cart"></i>
                    <span class="font-medium">Mi Carrito</span>
                    <span id="menu-cart-count" class="bg-yellow-400 text-green-900 text-xs px-2 py-0.5 rounded-full font-bold <?= $carritoItems == 0 ? 'hidden' : '' ?>">
                        <?= $carritoItems ?>
                    </span>
                </a>
            </li>

            <!-- Mis Compras / Historial -->
            <li>
                <a href="<?= BASE_URL ?>/index.php?module=carrito&action=historial" 
                   class="flex items-center space-x-2 px-4 py-3 text-white hover:bg-green-800 rounded-lg transition-colors whitespace-nowrap <?= ($currentModule == 'carrito' && in_array($currentAction, ['historial', 'detalle_compra', 'confirmacion'])) ? 'bg-green-800' : '' ?>">
                    <i class="fas fa-history"></i>
                    <span class="font-medium">Mis Compras</span>
                </a>
            </li>

            <!-- Mis Comentarios -->
            <li>
                <a href="<?= BASE_URL ?>/index.php?module=cliente&action=comentarios" 
                   class="flex items-center space-x-2 px-4 py-3 text-white hover:bg-green-800 rounded-lg transition-colors whitespace-nowrap <?= ($currentModule == 'cliente' && $currentAction == 'comentarios') ? 'bg-green-800' : '' ?>">
                    <i class="fas fa-comments"></i>
                    <span class="font-medium">Mis Comentarios</span>
                </a>
            </li>

            <!-- Mi Perfil -->
            <li>
                <a href="<?= BASE_URL ?>/index.php?module=cliente&action=perfil" 
                   class="flex items-center space-x-2 px-4 py-3 text-white hover:bg-green-800 rounded-lg transition-colors whitespace-nowrap <?= ($currentModule == 'cliente' && $currentAction == 'perfil') ? 'bg-green-800' : '' ?>">
                    <i class="fas fa-user-circle"></i>
                    <span class="font-medium">Mi Perfil</span>
                </a>
            </li>

            <!-- Separador y Ayuda -->
            <li class="ml-auto">
                <a href="<?= BASE_URL ?>/index.php?module=publico&action=contacto" 
                   class="flex items-center space-x-2 px-4 py-3 text-white hover:bg-green-800 rounded-lg transition-colors whitespace-nowrap">
                    <i class="fas fa-question-circle"></i>
                    <span class="font-medium">Ayuda</span>
                </a>
            </li>

        </ul>
    </div>
</nav>

<style>
    .scrollbar-hide::-webkit-scrollbar {
        display: none;
    }
    .scrollbar-hide {
        -ms-overflow-style: none;
        scrollbar-width: none;
    }
</style>

<script>
    // Actualizar contador del carrito en el menú
    function updateMenuCartCount() {
        fetch('<?= BASE_URL ?>/index.php?module=carrito&action=contador', {
            method: 'GET',
            headers: {
                'X-Requested-With': 'XMLHttpRequest'
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                const badge = document.getElementById('menu-cart-count');
                const cartCount = document.getElementById('cart-count');
                
                if (badge) {
                    badge.textContent = data.count;
                    if (data.count > 0) {
                        badge.classList.remove('hidden');
                    } else {
                        badge.classList.add('hidden');
                    }
                }
                
                // También actualizar el contador del header
                if (cartCount) {
                    cartCount.textContent = data.count;
                    if (data.count > 0) {
                        cartCount.classList.remove('hidden');
                    } else {
                        cartCount.classList.add('hidden');
                    }
                }
            }
        })
        .catch(error => console.error('Error:', error));
    }
    
    // Actualizar al cargar
    document.addEventListener('DOMContentLoaded', updateMenuCartCount);
    
    // Actualizar cada 30 segundos
    setInterval(updateMenuCartCount, 30000);
</script>